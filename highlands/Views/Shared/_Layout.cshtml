<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Antique Bakery Cafe</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="~/css/customer/logged.css?v=@DateTime.Now.Ticks">
</head>
<body>
    @if (ViewData["ShowNavbar"] == null || (bool)ViewData["ShowNavbar"])
    {
        <div class="navbar">
            <div class="navbar-logo">
                <a href="@Url.Action("Index", "Home")">
                    <img src="https://i.pinimg.com/736x/3b/ca/47/3bca470673bac72a5d8e409ab8ce306d.jpg" alt="Logo" class="logo">
                </a>

            </div>
            <ul class="navbar-menu">
                <li><a href="@Url.Action("Index", "Customer", new { area = "User" })">MENU</a></li>
                <li><a href="#">REWARDS</a></li>
                <li><a href="/Customer/Itemrcm">GIFT CARDS</a></li>
            </ul>
            <div class="navbar-user" style="margin-right: 40px; ">
                <div class="navbar-user-location">
                    <a href="https://www.google.com/maps" class="find-a-store-link">
                        <i class="fa-solid fa-location-dot"></i>
                        Find a store
                    </a>
                </div>
                <div class="navbar-user-menu">
                    <a href="#" class="user-btn" onclick="toggleMenu()">
                        <i class="fa-regular fa-user"></i>
                    </a>
                    <ul class="dropdown-menu">
                        <li class="dropdown-menu-item">
                            <a href="@Url.Action("CustomerDataInsertForm", "Customer", new { area = "User" })">
                                <span class="item-icon">
                                    <i class='bx bxs-dashboard'></i>
                                </span>
                                <span class="item-txt">Dashboard</span>
                            </a>
                        </li>
                        <li class="dropdown-menu-item">
                            <a href="#">
                                <span class="item-icon">
                                    <i class='bx bx-cog'></i>
                                </span>
                                <span class="item-txt">Settings</span>
                            </a>
                        </li>
                        <li class="dropdown-menu-item">
                            <a href="/Account/Logout">
                                <span class="item-icon">
                                    <i class='bx bx-log-out'></i>
                                </span>
                                <span class="item-txt">Logout</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    }
    <div class="super-container">
        <!-- Navbar Menu -->
        @if (ViewData["ShowNavbarMenu"] == null || (bool)ViewData["ShowNavbarMenu"])
        {
            <div class="subnav-container">
                <nav aria-label="Menu">
                    <ul class="subnav-list">
                        <li><a aria-current="page" class="subnav-item active" href="@Url.Action("Index", "Customer", new { area = "User" })">Menu</a></li>
                        <li><a class="subnav-item" href="https://www.starbucks.com/menu/featured">Featured</a></li>
                        <li><a class="subnav-item" href="/menu/previous">Previous</a></li>
                        <li><a class="subnav-item" href="/menu/favorites">Favorites</a></li>
                    </ul>
                </nav>
            </div>
        }

        <div>
            @RenderBody()
        </div>

        @if (ViewData["ShowFooter"] == null || (bool)ViewData["ShowFooter"])
        {
            <footer class="footer-content">
                <div class="footer-container">
                    <div class="footer-column">
                        <h3>About Us</h3>
                        <ul>
                            <li><a href="#">Our Company</a></li>
                            <li><a href="#">Our Coffee</a></li>
                            <li><a href="#">About Starbucks</a></li>
                            <li><a href="#">Starbucks Archive</a></li>
                            <li><a href="#">Investor Relations</a></li>
                            <li><a href="#">Customer Service</a></li>
                            <li><a href="#">Contact Us</a></li>
                        </ul>
                    </div>
                    <div class="footer-column">
                        <h3>Careers</h3>
                        <ul>
                            <li><a href="#">Culture and Values</a></li>
                            <li><a href="#">Belonging at Starbucks</a></li>
                            <li><a href="#">College Achievement Plan</a></li>
                            <li><a href="#">Alumni Community</a></li>
                            <li><a href="#">U.S. Careers</a></li>
                            <li><a href="#">International Careers</a></li>
                        </ul>
                    </div>
                    <div class="footer-column">
                        <h3>Social Impact</h3>
                        <ul>
                            <li><a href="#">Communities</a></li>
                            <li><a href="#">Starbucks Foundation</a></li>
                            <li><a href="#">Sustainability</a></li>
                            <li><a href="#">Environmental and Social Impact Reporting</a></li>
                        </ul>
                    </div>
                    <div class="footer-column">
                        <h3>For Business Partners</h3>
                        <ul>
                            <li><a href="#">Landlord Support Center</a></li>
                            <li><a href="#">Suppliers</a></li>
                            <li><a href="#">Corporate Gift Card Sales</a></li>
                            <li><a href="#">Office and Foodservice Coffee</a></li>
                        </ul>
                    </div>
                    <div class="footer-column">
                        <h3>Order and Pick Up</h3>
                        <ul>
                            <li><a href="#">Order on the App</a></li>
                            <li><a href="#">Order on the Web</a></li>
                            <li><a href="#">Delivery</a></li>
                            <li><a href="#">Order and Pick Up Options</a></li>
                            <li><a href="#">Explore and Find Coffee for Home</a></li>
                        </ul>
                    </div>
                </div>
                <div class="footer-shared">
                    <div class="availability">
                        <span>For item availability</span>
                        <div class="dropdown">
                            <span class="choose-store"><strong>Choose a store</strong></span>
                            <span class="arrow">&#9662;</span>
                        </div>
                    </div>
                    <div class="cart-icon" onclick="window.location.href='@Url.Action("ReviewOrder", "Customer", new { area = "User" })'">
                        <span class="cart-count">@ViewBag.TotalQuantity</span>
                        <i class="fa-solid fa-bag-shopping"></i>
                    </div>
                </div>
            </footer>
        }
    </div>
</body>
</html>
<script>
        function toggleMenu() {
        const menu = document.querySelector(".dropdown-menu");
        menu.classList.toggle("show");
    }

    // Đóng menu khi nhấp ra ngoài
    document.addEventListener("click", function (e) {
        const menu = document.querySelector(".dropdown-menu");
        const button = document.querySelector(".user-btn");

        if (!menu.contains(e.target) && !button.contains(e.target)) {
            menu.classList.remove("show");
        }
    });

    function updateCartQuantity() {
        $.ajax({
            url: "/Customer/GetCartQuantity",
            type: "GET",
            success: function (response) {
                console.log("[DEBUG] Cart Quantity Response:", response); // Debug API response

                if (response.success) {
                    $(".cart-count").text(response.quantity);
                }
            },
            error: function () {
                console.error("[ERROR] Failed to update cart quantity");
            }
        });
    }
    updateCartQuantity();

    $(document).on("cartUpdated", function () {
        updateCartQuantity();
    });
</script>
